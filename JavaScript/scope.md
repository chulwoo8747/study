# scope

## 스코프란?

---

### 스코프는 참조 대상 식별자(identifier, 변수, 함수의 이름과 같이 어떤 대상을 다른 대상과 구분하여 식별할 수 있는 유일한 이름)를 찾아내기 위한 규칙입니다. 자바스크립트는 이 규칙대로 식별자를 찾는다.

<aside>
🤔 만약 스코프가 없다면?

</aside>

→ 스코프가 없다면 같은 식별자 이름은 충돌을일으키므로 프로그램 전체에서 하나밖에 사용할 수 없다. 디렉터리가 없는 컴퓨터를 생각해보면 디렉터리가 없다면 같은 이름을 갖는 파일을 하나밖에 만들 수 없다. 스코프도 이와 같이 식별자 이름의 충돌을 방지한다.

### 전역 스코프 (Global scope) → 코드 어디에서든 참조할 수 있다.

### 지역 스코프 (Local scope or Function-level scope)

### → 함수 코드 블록이 만든 스코프로 함수 자신과 하위 함수에서만 참조할 수 있다.

변수는 선언 위치(전역 또는 지역)에 의해 스코프를 가지게 된다. 즉, 전역에서 선언된 변수는 전역 스코프를 갖는 전역 변수이고, 지역(js의 경우 함수 내부)에서 선언된 변수는 지역 스코프를 갖는 지역 변수가 된다.

## js 스코프의 특징

---

대부분의 c-family language는 블록 레벨(block-level scope)를 따릅니다. 블록 레벨 스코프란 코드 블록({~~})내에서 유효한 스코프를 의미한다.

하지만 js는 함수 레벨 스코프를(function-level scope)를 따른다. 함수 레벨 스코프란 함수 코드 블록 내에서 선언된 변수는 함수 코드 블록 내에서만 유효하고 함수 외부에서는 유효하지 않다는 것이다.

→단 **let keyword를 사용하면 블록 레벨 스코프를 사용할 수 있다.**

## 전역 스코프(Global scope)

---

전역에 변수를 선언 하면 이 변수는 어디서든지 참조할 수 있는 전역 스코프를 같는 전역 변수가 된다. var 키워드로 선언한 전역 변수는 전역 객체(Global Object) window의 프로퍼티이다.

```jsx
var jikwan = 6;

function num() {
    console.log(jikwan);
}
num();

console.log(jikwan);
```

변수 jikwan은 함수 영역 밖의 전역에서 선언되었다. js는 다른 C-family language와는 달리 특별한 시점이 없으며 코드가 나타나는 즉시 해석되고 실행된다. 

전역 변수의 사용은 변수 이름이 중복될 수 있고, **의도치 않은 재할당에 의한 상태 변화로 코드를 예측하기 어렵게 만드므로 사용을 자제해야 한다.**

## 비 블록 레벨 스코프(Non block-level scope)

---

```jsx
if (true) {
    var chulwoo = 8;
}
console.log(chulwoo);
```

변수 chulwoo는 코드 블록 내에서 선언되었다. 하지만 js는 블록 레벨 스코프를 사용하지 않으므로 함수 밖에서 선언된 변수는 코드 블록 내에서 선언되었다할지라도 모두 전역 스코프를 갖게된다. 따라서 변수 chulwoo는 전역 변수이다. 

## 함수 레벨 스코프(Function-level scope)

```jsx
var js = 10;

(function () {
    var c = 20;
})();

console.log(js);
console.log(c); 
```

js는 함수 레벨 스코프흘 사용한다. 즉, 함수 내에서 선언된 매개변수와 변수는 함수 외부에서는 유효하지 않는다. 따라서 변수 c는 지역 변수이다.

만약 전역변수와 지역변수가 중복 선언 되었을 때는 전역 영역에서는 전역변수만이 참조 가능하고 함수 내 지역 영역에서는 전역과 지역 변수 모두 참조 가능하나 변수 명이 중복된 경우, 지역변수를 우선하여 참조한다. 

## 렉시컬 스코프

---

프로그래밍 언어는 두가지 방식 중 하나의 방식으로 함수의 상위 스코프를 결정한다. 첫번째 방식을 동적 스코프라 하고, 두번째 방식을 렉시컬 스코프 또는 정적 스코프라 합니다. js를 비롯한 대부분의 프로그래밍 언어는 렉시컬 스코프를 따른다.

렉시컬 스코프는 함수를 어디서 호출하는지가 아니라 어디에 선언하였는지에 따라 결정된다. js는 렉시컬 스코프를 따르므로 함수를 선언한 시점에 상위 스코프가 결정된다. 함수를 어디에서 호출하였는지는 스코프 결정에 아무런 의미를 주지 않는다.

## 암묵적 전역

---

```jsx
var x = 10;

function js() {
    y = 20;
    console.log(x+y);
}

js();
```

위 코드의 y는 선언하지 않은 식별자이다. 따라서 y = 20이 실행되면 참조 에러가 발생할 것 처럼 보인다. 하지만 js 엔진은 y =20을 window.y = 20으로 해석하여 프로퍼티를 동적으로 생성한다. 결국 y는 전역 객체의 프로퍼티가 되어 마치 전역 변수처럼 동작합니다 이러한 현상을 **암묵적 전역**이라한다.